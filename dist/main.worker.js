(()=>{"use strict";function e(e){return" \r\n\t".indexOf(e)>=0}function s(s){for(var a,t,n,r=["topLevel"],c=0,o=function(e){return r.push(e)},u=function(e){return r[r.length-1]=e},i=function(e){null==a&&(a=c,t=r.length,n=e)},d=function(e){e===n&&(a=void 0,t=void 0,n=void 0)},l=function(){return r.pop()},b=function(){return c--},N=function(e){if("0"<=e&&e<="9")o("number");else switch(e){case'"':return void o("string");case"-":return void o("numberNeedsDigit");case"t":return void o("true");case"f":return void o("false");case"n":return void o("null");case"[":return void o("arrayNeedsValue");case"{":return void o("objectNeedsKey")}},m=s.length;c<m;c++){var g=s[c];switch(r[r.length-1]){case"topLevel":N(g);break;case"string":switch(g){case'"':l();break;case"\\":i("stringEscape"),o("stringEscaped")}break;case"stringEscaped":"u"===g?o("stringUnicode"):(d("stringEscape"),l());break;case"stringUnicode":c-s.lastIndexOf("u",c)==4&&(d("stringEscape"),l());break;case"number":"."===g?u("numberNeedsDigit"):"e"===g||"E"===g?u("numberNeedsExponent"):(g<"0"||g>"9")&&(b(),l());break;case"numberNeedsDigit":u("number");break;case"numberNeedsExponent":u("+"===g||"-"===g?"numberNeedsDigit":"number");break;case"true":case"false":case"null":(g<"a"||g>"z")&&(b(),l());break;case"arrayNeedsValue":"]"===g?l():e(g)||(d("collectionItem"),u("arrayNeedsComma"),N(g));break;case"arrayNeedsComma":"]"===g?l():","===g&&(i("collectionItem"),u("arrayNeedsValue"));break;case"objectNeedsKey":"}"===g?l():'"'===g&&(i("collectionItem"),u("objectNeedsColon"),o("string"));break;case"objectNeedsColon":":"===g&&u("objectNeedsValue");break;case"objectNeedsValue":e(g)||(d("collectionItem"),u("objectNeedsComma"),N(g));break;case"objectNeedsComma":"}"===g?l():","===g&&(i("collectionItem"),u("objectNeedsKey"))}}null!=t&&(r.length=t);for(var f=[null!=a?s.slice(0,a):s],p=function(e){return f.push(e.slice(s.length-s.lastIndexOf(e[0])))},k=r.length-1;k>=0;k--)switch(r[k]){case"string":f.push('"');break;case"numberNeedsDigit":case"numberNeedsExponent":f.push("0");break;case"true":p("true");break;case"false":p("false");break;case"null":p("null");break;case"arrayNeedsValue":case"arrayNeedsComma":f.push("]");break;case"objectNeedsKey":case"objectNeedsColon":case"objectNeedsValue":case"objectNeedsComma":f.push("}")}return f.join("")}self.onmessage=async e=>{const a=e.data,t=(await fetch(URL.createObjectURL(a))).body.getReader();let n="";for(;;){const{done:e,value:a}=await t.read();if(e)break;n+=new TextDecoder("utf-8").decode(a);const r=JSON.parse(s(n)),c=(new TextEncoder).encode(JSON.stringify(r)).length;postMessage({size:c,data:r})}const r=JSON.parse(n);postMessage(r)}})();